<html>
<head>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <meta name="viewport", content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script type="text/javascript">
      document.ontouchmove = function(event){
        event.preventDefault();
      }
    </script> 
    <style type="text/css">
        #mynetwork {
            width: 1800px;
            height: 1000px;
            border: 1px solid lightgray;
        }
        #summary{
          padding-right: 5px;
        }
        #summary::-webkit-scrollbar {
            width: 12px; /* Width of the vertical scrollbar */
            
        }

        /* The track (background) of the scrollbar */
        #summary::-webkit-scrollbar-track {
            background: #f1f1f1; /* Color of the track */
        }

        /* The thumb (scroll handle) of the scrollbar */
        #summary::-webkit-scrollbar-thumb {
            background: #a2a9b1; /* Color of the thumb */
        }

        /* The thumb on hover */
        #summary::-webkit-scrollbar-thumb:hover {
            background: #555; /* Color of the thumb when hovered */
        }
    </style>
</head>
<body>
    <div id="mynetwork">
        
    </div>

</body>
<script type="text/javascript">
const description_regex = /<p id="mwCw">.*?<\/p>/i;
const plain_text_regex = /<[^>]+>/g;

var nodes = new vis.DataSet([
  { id: "Wave_function", label: "Node 1"},
  { id: "Land", label: "Node 2"},
  { id: 3, label: "Node 3"},
  { id: 4, label: "Node 4"},
  { id: 5, label: "Node 5"},
]);

// create an array with edges
var edges = new vis.DataSet([
  { from: "Wave_function", to: 3 },
  { from: "Wave_function", to: "Land" },
  { from: "Land", to: 4 },
  { from: "Land", to: 5 },
]);

// create a network
var container = document.getElementById("mynetwork");
var data = {
  nodes: nodes,
  edges: edges,
};

var options = {
  manipulation: {
    enabled: true,
  },
};

var network = new vis.Network(container, data, options);

var position_offest_x = 200;
var position_offest_y = -150;
var network_container = document.getElementsByClassName("vis-network")[0];
var new_div = document.createElement("div");
new_div.style = "width: 500px; height: 300px; background-color: white; max-height: 300px; border: 1px solid #a2a9b1; display:flex; flex-direction: column;"
new_div.innerHTML = `
            <h1 id="header" style="color:black;border-bottom:1px solid #a2a9b1; margin: 0 0 0 0.5em; font-size: 1.8rem; font-weight: normal;"></h1>
            <div style="display: flex; flex-direction: row; min-height:0">
                <p id="summary" style="font-family: sans-serif; margin:0;margin-left:1em; padding-top:0.5em; padding-bottom:1em; overflow-y: auto; font-size:1.2em;flex: 1 1 0%; flex-grow: 2;"></p>
                <img id="image" style="max-width: 40%; object-fit: cover" >
            </div>
    `;
new_div.style.position = "absolute";
new_div.style.visibility = "hidden" 

network_container.appendChild(new_div);
const SUMMARY_CONTAINER = document.getElementById("summary");
const HEADER_CONTAINER = document.getElementById("header");
const IMAGE_CONTAINER = document.getElementById("image");
var attached_node;

network.on("dragging", function (params) {
    if(new_div.style.visibility == "visible"){
        const viewport_pos = network.getViewPosition()
        const node_pos = network.getPosition(attached_node);
        new_div.style.left = ((node_pos.x-viewport_pos.x+position_offest_x)*network.getScale()+900)
        new_div.style.top = ((node_pos.y-viewport_pos.y+position_offest_y)*network.getScale()+500)
        
    }
});

network.on("zoom", function (params) {
    new_div.style.width = ((500*network.getScale()).toString()+"px")
    new_div.style.height = ((300*network.getScale()).toString()+"px")
    HEADER_CONTAINER.style.fontSize = (1.8*network.getScale()).toString()+"em";
    SUMMARY_CONTAINER.style.fontSize = (1.2*network.getScale()).toString()+"em";
    if(attached_node){
      const viewport_pos = network.getViewPosition()
      const node_pos =network.getPosition(attached_node)
      new_div.style.left = ((node_pos.x-viewport_pos.x+position_offest_x)*network.getScale()+900)
      new_div.style.top = ((node_pos.y-viewport_pos.y+position_offest_y)*network.getScale()+500)
    }
});

network.on("selectNode", async function (params) {
    if(params.nodes[0]){
      var fetch_response =await fetch('https://en.wikipedia.org/api/rest_v1/page/summary/'+params.nodes[0])
      .then(response => {return response.json()});
      console.log(fetch_response.extract)
      HEADER_CONTAINER.innerText = fetch_response.title;
      SUMMARY_CONTAINER.innerText = fetch_response.extract;
      if(fetch_response.thumbnail){
        IMAGE_CONTAINER.src=fetch_response.thumbnail.source;
      }else{
        IMAGE_CONTAINER.src = "";
      }
            new_div.style.visibility = "visible";
            attached_node = params.nodes[0];
            const node_pos =network.getPosition(attached_node)
            const viewport_pos = network.getViewPosition()
            new_div.style.left = ((node_pos.x-viewport_pos.x+position_offest_x)*network.getScale()+900)
            new_div.style.top = ((node_pos.y-viewport_pos.y+position_offest_y)*network.getScale()+500)
    }
});
network.on("selectEdge", function (params) {
  console.log("selectEdge Event:", params);
});
network.on("deselectNode", function (params) {
  new_div.style.visibility = "hidden";
});
network.on("deselectEdge", function (params) {
  console.log("deselectEdge Event:", params);
});
network.on("hoverEdge", function (params) {
  console.log("hoverEdge Event:", params);
});
    
</script>

</html>
